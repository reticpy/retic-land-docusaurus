(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{128:function(e,n,a){"use strict";a.r(n),n.default=a.p+"assets/images/api_rest_app_5-c760a83eb996eed444535e2e4a6e3d68.png"},76:function(e,n,a){"use strict";a.r(n),a.d(n,"frontMatter",(function(){return i})),a.d(n,"metadata",(function(){return o})),a.d(n,"rightToc",(function(){return p})),a.d(n,"default",(function(){return l}));var r=a(2),t=a(6),s=(a(0),a(89)),i={id:"external-apps",title:"Aplicaciones externas",sidebar_label:"Aplicaciones externas",description:"Aplicaciones externas",slug:"/tutorial/external-apps"},o={unversionedId:"tutorial/external-apps",id:"tutorial/external-apps",isDocsHomePage:!1,title:"Aplicaciones externas",description:"Aplicaciones externas",source:"@site/docs\\es\\tutorial\\external-apps.md",slug:"/tutorial/external-apps",permalink:"/manual/tutorial/external-apps",editUrl:"https://github.com/reticpy/retic-land-docusaurus/edit/master/docs/tutorial/external-apps.md",version:"current",sidebar_label:"Aplicaciones externas",sidebar:"docs",previous:{title:"Archivo de configuraci\xf3n",permalink:"/manual/tutorial/settings"},next:{title:"Arquitectura",permalink:"/manual/concepts/architecture"}},p=[],c={rightToc:p};function l(e){var n=e.components,i=Object(t.a)(e,["components"]);return Object(s.b)("wrapper",Object(r.a)({},c,i,{components:n,mdxType:"MDXLayout"}),Object(s.b)("p",null,Object(s.b)("em",{parentName:"p"},"Estructura de carpetas utilizada:")),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"\nretic-restapi-example\n\u2502\n\u2514\u2500\u2500\u2500apps\n\u2502   \u2502   urls.py\n\u2502   \u2502   ...\n|\n\u2514\u2500\u2500\u2500controllers\n\u2502   \u2502   users.py\n\u2502   \u2502   ...\n\u2502\n\u2514\u2500\u2500\u2500routes\n\u2502   \u2502   __init__.py\n\u2502   \u2502   routes.py\n|   \u2502   ...\n|\n\u2514\u2500\u2500\u2500services\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500users\n\u2502       \u2502   users.py\n\u2502       \u2502   ...\n\u2502   ...\n\u2502   .env.development\n\u2502   .env.staging\n\u2502   .env.production\n\u2502   app.py\n\u2502   requirements.txt\n\u2502   settings.py\n\n")),Object(s.b)("p",null,"Retic recomienda realizar un archivo de rutas de aplicaciones externas, de esta forma se asegura la mantenibilidad y escalabilidad de la aplicaci\xf3n. De la misma forma, guardar la informaci\xf3n en Retic para ser capaz de utilizarla en toda la aplicaci\xf3n."),Object(s.b)("p",null,"Actualiza el archivo de variables de entorno."),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"\n# .env.development\n\n#App\nAPP_HOSTNAME                     =localhost\nAPP_PORT                         =1801\nAPP_ENV                          =development\n\n#Apps\nAPP_BACKEND_EXAMPLE      =https://jsonplaceholder.typicode.com\n\n")),Object(s.b)("p",null,"Crea un archivo ",Object(s.b)("inlineCode",{parentName:"p"},"apps/urls.py")," y agrega la configuraci\xf3n de las rutas de tus aplicaciones externas."),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-python"}),'\n# apps/urls.py\n\n# Retic\nfrom retic import App as app\n\n"""Define otras aplicaciones"""\nBACKEND_EXAMPLE = {\n    u"base_url": app.config.get(\'APP_BACKEND_EXAMPLE\'),\n    u"users": "/users",\n}\n\n"""Crea el objeto referencia de las apps"""\nAPP_BACKEND = {\n    u"example": BACKEND_EXAMPLE,\n}\n\n"""Agrega las aplicaciones a Retic"""\napp.use(APP_BACKEND, "backend")\n\n')),Object(s.b)("p",null,"Actualiza el archivo principal ",Object(s.b)("inlineCode",{parentName:"p"},"app.py")," y agrega el archivo de configuraci\xf3n:"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-python"}),'\n# app.py\n\n"""Main app"""\n\n# Retic\nfrom retic import App as app\n\n# Settings\nimport settings\n\n# Apps\nfrom apps.urls import APP_BACKEND\n\n# Routes\nfrom routes import router\n\n# Agregar las rutas a la aplicaci\xf3n\napp.use(router)\n\nif __name__ == "__main__":\n    # Crear servidor web\n    app.listen(\n        # Obtener la variable de entorno APP_HOSTNAME en el formato por defecto (str)\n        hostname=app.env("APP_HOSTNAME"),\n        # Obtener la variable de entorno APP_PORT en formato n\xfamerico. De no existir, retorna 1801.\n        port=app.env.int("APP_PORT", 1801),\n    )\n\n\n')),Object(s.b)("p",null,"Instala el paquete ",Object(s.b)("inlineCode",{parentName:"p"},"requests")," para realizar llamadas HTTP."),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"\n# requiremets.txt\n\nretic==0.1.1\nrequests==2.24.0\n\n")),Object(s.b)("p",null,"Instala las dependencias con el siguiente comando:"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"\npip install -r requirements.txt\n\n")),Object(s.b)("p",null,"Actualiza el servicio ",Object(s.b)("inlineCode",{parentName:"p"},"services/users/users.py")," realizando el consumo de la apicaci\xf3n externa:"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-python"}),'\n# services/users/users.py\n\n"""Servicios para el controlador de usuarios"""\n\n# Retic\nfrom retic import App as app\n\n# Requests\nimport requests\n\n# Constants\nURL_USERS = app.apps[\'backend\'][\'example\'][\'base_url\'] + \\\n    app.apps[\'backend\'][\'example\'][\'users\']\n\n\ndef get_by_id_db(user_id):\n    """Encontrar un usuario en base a un identificador\n\n    :param user_id: Identificador del usuario\n    """\n\n    """Declarar variables"""\n    user = None\n\n    """Obtener todos los usuarios"""\n    users_req = requests.get(URL_USERS)\n\n    """Transformar en json"""\n    users = users_req.json()\n\n    """Realizar la busqueda"""\n    for _user in users:\n        if _user["id"] == user_id:\n            user = _user\n\n    """Retornar informaci\xf3n"""\n    return user\n\n')),Object(s.b)("p",null,"Actualiza el controlador ",Object(s.b)("inlineCode",{parentName:"p"},"controllers/users.py")," aplicando la validaci\xf3n de que el usuario s\xed existe:"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-python"}),'\n# controllers/users.py\n\n# Retic\nfrom retic import Request, Response, Next\n\n# Services\nfrom services.users import users\n\n\ndef get_by_id(req: Request, res: Response, next: Next):\n    """Obtener un usuario por su identificador"""\n\n    user = users.get_by_id_db(req.param("id", callback=int))\n\n    """Transformar informaci\xf3n de respuesta"""\n    if user:\n        """Retornar una respuesta al cliente"""\n        res.ok({\n            u"valid": True,\n            u"msg": "Usuario encontrado.",\n            u"data": user\n        })\n    else:\n        """Retornar un mensaje de error al cliente"""\n        res.not_found({\n            u"valid": False,\n            u"msg": "Usuario no encontrado."\n        })\n\n')),Object(s.b)("p",null,"Visita el siguiente enlace ",Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"http://localhost:1801/users/1"}),"http://localhost:1801/users/1")," para ver el resultado."),Object(s.b)("p",null,Object(s.b)("img",{alt:"alt text",src:a(128).default,title:"API REST"})))}l.isMDXComponent=!0},89:function(e,n,a){"use strict";a.d(n,"a",(function(){return u})),a.d(n,"b",(function(){return m}));var r=a(0),t=a.n(r);function s(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function i(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?i(Object(a),!0).forEach((function(n){s(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function p(e,n){if(null==e)return{};var a,r,t=function(e,n){if(null==e)return{};var a,r,t={},s=Object.keys(e);for(r=0;r<s.length;r++)a=s[r],n.indexOf(a)>=0||(t[a]=e[a]);return t}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)a=s[r],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(t[a]=e[a])}return t}var c=t.a.createContext({}),l=function(e){var n=t.a.useContext(c),a=n;return e&&(a="function"==typeof e?e(n):o(o({},n),e)),a},u=function(e){var n=l(e.components);return t.a.createElement(c.Provider,{value:n},e.children)},b={inlineCode:"code",wrapper:function(e){var n=e.children;return t.a.createElement(t.a.Fragment,{},n)}},d=t.a.forwardRef((function(e,n){var a=e.components,r=e.mdxType,s=e.originalType,i=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),u=l(a),d=r,m=u["".concat(i,".").concat(d)]||u[d]||b[d]||s;return a?t.a.createElement(m,o(o({ref:n},c),{},{components:a})):t.a.createElement(m,o({ref:n},c))}));function m(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var s=a.length,i=new Array(s);i[0]=d;var o={};for(var p in n)hasOwnProperty.call(n,p)&&(o[p]=n[p]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var c=2;c<s;c++)i[c]=a[c];return t.a.createElement.apply(null,i)}return t.a.createElement.apply(null,a)}d.displayName="MDXCreateElement"}}]);