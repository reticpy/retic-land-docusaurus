(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{73:function(e,n,a){"use strict";a.r(n),a.d(n,"frontMatter",(function(){return o})),a.d(n,"metadata",(function(){return c})),a.d(n,"rightToc",(function(){return l})),a.d(n,"default",(function(){return p}));var t=a(2),r=a(6),s=(a(0),a(89)),o={id:"response",title:"Response",sidebar_label:"Response",description:"Response",slug:"/api/response"},c={unversionedId:"api/response",id:"api/response",isDocsHomePage:!1,title:"Response",description:"Response",source:"@site/docs\\es\\api\\response.md",slug:"/api/response",permalink:"/manual/api/response",editUrl:"https://github.com/reticpy/retic-land-docusaurus/edit/master/docs/api/response.md",version:"current",sidebar_label:"Response",sidebar:"docs",previous:{title:"Request",permalink:"/manual/api/request"},next:{title:"Next",permalink:"/manual/api/next"}},l=[{value:"Clase Response",id:"clase-response",children:[{value:"Propiedades",id:"propiedades",children:[]},{value:"Funciones",id:"funciones",children:[]},{value:"Otras propiedades y funciones",id:"otras-propiedades-y-funciones",children:[]}]}],i={rightToc:l};function p(e){var n=e.components,a=Object(r.a)(e,["components"]);return Object(s.b)("wrapper",Object(t.a)({},i,a,{components:n,mdxType:"MDXLayout"}),Object(s.b)("h2",{id:"clase-response"},"Clase Response"),Object(s.b)("p",null,"La clase ",Object(s.b)("strong",{parentName:"p"},"Response")," representa la respuesta a una petici\xf3n HTTP realizada por un cliente."),Object(s.b)("h3",{id:"propiedades"},"Propiedades"),Object(s.b)("p",null,"A continuaci\xf3n se presentan las principales propiedades de la clase ",Object(s.b)("inlineCode",{parentName:"p"},"Response")," y su funcionalidad."),Object(s.b)("h4",{id:"default_mimetype"},"default_mimetype"),Object(s.b)("p",null,"Todas las respuestas tienen un por defecto un mimetype ",Object(s.b)("inlineCode",{parentName:"p"},"text/plain"),"."),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-python"}),"\n# Valor actual de default_mimetype\nres.default_mimetype: 'text/plain'\n\n")),Object(s.b)("h4",{id:"default_status"},"default_status"),Object(s.b)("p",null,"Todas las respuestas tienen un por defecto un codigo de estado de respuesta ",Object(s.b)("inlineCode",{parentName:"p"},"status 200"),"."),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-python"}),"\n# Valor actual de default_status\nres.default_status: 200\n\n")),Object(s.b)("h4",{id:"headers"},"headers"),Object(s.b)("p",null,"Lista de todas las cabeceras de la respuesta. Por defecto, todas las peticiones tienen la cabecera. ",Object(s.b)("inlineCode",{parentName:"p"},"'content-type': 'application/json'")),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-python"}),"\n# Valor actual de headers\nHeaders([('content-type', 'application/json'), ('Access-Control-Allow-Methods', 'True'), ('Access-Control-Allow-Credentials', 'GET,POST,DELETE,PUT,OPTIONS'), ('Access-Control-Allow-Origin', '*'), ('Access-Control-Allow-Headers', 'Content-Type'), ('Access-Control-Expose-Headers', 'Content-Type')])\n\n")),Object(s.b)("h4",{id:"status"},"status"),Object(s.b)("p",null,"C\xf3digo de estado de la respuesta en formato de cadena de texto."),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-python"}),"\n# Valor actual de status\nres.status: '200 OK'\n\n")),Object(s.b)("h4",{id:"status_code"},"status_code"),Object(s.b)("p",null,"C\xf3digo de estado de la respuesta en formato n\xfamerico."),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-python"}),"\n# Valor actual de status_code\nres.status_code: 200\n\n")),Object(s.b)("h3",{id:"funciones"},"Funciones"),Object(s.b)("p",null,"La clase ",Object(s.b)("strong",{parentName:"p"},"Response")," utiliza las siguientes funciones para manipulaci\xf3n de su informaci\xf3n."),Object(s.b)("h4",{id:"bad_requestcontent-any--"},"bad_request(",Object(s.b)("em",{parentName:"h4"},"content: any"),' = "")'),Object(s.b)("p",null,"Este m\xe9todo responde con un ",Object(s.b)("em",{parentName:"p"},"400 Bad Request")," a la petici\xf3n del cliente, esto indica que la solicitud no es v\xe1lida."),Object(s.b)("p",null,"Esto generalmente significa que la solicitud conten\xeda par\xe1metros o cabeceras no v\xe1lidas, o que intent\xf3 hacer algo que la l\xf3gica de su aplicaci\xf3n no admite."),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"Par\xe1metros:")),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"content"),": Informaci\xf3n para enviar al cliente, un mensaje, un diccionario, etc. Si no existe, env\xeda un mensaje de estado basado en el c\xf3digo de estado.")),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-python"}),'\n# Retic\nfrom retic import Request, Response\nfrom retic.services.responses import error_response\nfrom retic.services.validations import validate_obligate_fields\n\ndef upload(req: Request, res: Response):\n\n    """Revisar que todos los parametros obligatorios sean validos"""\n    _validate = validate_obligate_fields({\n        u\'files\': _files\n    })\n\n    if _validate["valid"] is False:\n        return res.bad_request(\n            error_response(\n                "The param {} is necesary.".format(_validate["error"])\n            )\n        )\n\n')),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-sh"}),'\n# Salida:\n{\n    "valid": false,\n    "msg": "The param files is necesary."\n}\n\n')),Object(s.b)("h4",{id:"forbiddencontent-any--"},"forbidden(",Object(s.b)("em",{parentName:"h4"},"content: any"),' = "")'),Object(s.b)("p",null,"Este m\xe9todo se utiliza para enviar una respuesta ",Object(s.b)("em",{parentName:"p"},"403 forbidden")," al cliente, indicando que una solicitud no est\xe1 autorizada."),Object(s.b)("p",null,"Esto generalmente significa que el agente de usuario intent\xf3 hacer algo que ellos no estaban autorizados para hacerlo, como cambiar la contrase\xf1a de otro usuario."),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"Par\xe1metros:")),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"content"),": Informaci\xf3n para enviar al cliente, un mensaje, un diccionario, etc. Si no existe, env\xeda un mensaje de estado basado en el c\xf3digo de estado.")),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-python"}),'\n# Retic\nfrom retic import Request, Response\nfrom retic.services.responses import error_response\n\n# Services\nfrom services.users.users as users\n\ndef login(req: Request, res: Response):\n\n    """Revisar que todos los parametros obligatorios sean validos"""\n    _user = users.login({\n        u\'username\': "user1",\n        u\'password\': "123",\n    })\n\n    if _user["valid"] is False:\n        return res.forbidden(\n            error_response("User is invalid.")\n        )\n\n')),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-sh"}),'\n# Salida:\n{\n    "valid": false,\n    "msg": "User is invalid."\n}\n\n')),Object(s.b)("h4",{id:"not_foundcontent-any--"},"not_found(",Object(s.b)("em",{parentName:"h4"},"content: any"),' = "")'),Object(s.b)("p",null,"Este m\xe9todo se utiliza para enviar una respuesta ",Object(s.b)("em",{parentName:"p"},"404 not_found"),"."),Object(s.b)("p",null,"Cuando se llama manualmente desde el c\xf3digo de su aplicaci\xf3n, este m\xe9todo normalmente se usa para indica que el cleinte intent\xf3 encontrar, actualizar o eliminar algo que no existe."),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"Par\xe1metros:")),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"content"),": Informaci\xf3n para enviar al cliente, un mensaje, un diccionario, etc. Si no existe, env\xeda un mensaje de estado basado en el c\xf3digo de estado.")),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-python"}),'\n# URL de la petici\xf3n HTTP\n# GET: http://localhost:1801/folders/86698adcb9b711eaa7524c0082ae1a80\n\n# Retic\nfrom retic import Request, Response\n\n# Services\nfrom services.files.files as files\n\ndef get_by_folder(req: Request, res: Response):\n    """Obtener archivos en base a su directorio"""\n    _files_db = files.get_all_by_folder_db(\n        req.param("folder")\n    )\n\n    """Revisar si se encontr\xf3 el folder, caso contrario, retornar un error."""\n    if _files_db[\'valid\'] is False:\n        res.not_found(_files_db)\n    else:\n        res.ok(_files_db)\n\n')),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-sh"}),'\n# Salida:\n{\n    "valid": false,\n    "msg": "Folder not found."\n}\n\n')),Object(s.b)("h4",{id:"okcontent-dict--none"},"ok(",Object(s.b)("em",{parentName:"h4"},"content: dict")," = None)"),Object(s.b)("p",null,"Este m\xe9todo se utiliza para enviar una respuesta ",Object(s.b)("em",{parentName:"p"},"200 OK")," al cliente."),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"Par\xe1metros:")),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"content"),": Informaci\xf3n para enviar al cliente, un mensaje, un diccionario, etc. Si no existe, env\xeda un mensaje de estado basado en el c\xf3digo de estado.")),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-python"}),'\n# URL de la petici\xf3n HTTP\n# GET: http://localhost:1801/folders/77698adcb9b711eaa7524c0082ae1a80\n\n#Retic\nfrom retic import Request, Response\n\n# Services\nfrom services.files.files as files\n\ndef get_by_folder(req: Request, res: Response):\n    """Obtener archivos en base a su directorio"""\n    _files_db = files.get_all_by_folder_db(\n        req.param("folder")\n    )\n\n    """Revisar si se encontr\xf3 el folder, caso contrario, retornar un error."""\n    if _files_db[\'valid\'] is False:\n        res.not_found(_files_db)\n    else:\n        res.ok(_files_db)\n\n')),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-sh"}),'\n# Salida:\n{\n    "valid": true,\n    "msg": "Files found.",\n    "data": {\n        "success": [\n            {\n                "mimetype": "image/png",\n                "filename": "200px-Flag_of_Spain.svg.png",\n                "created_at": "2020-06-28 22:20",\n                "cloud": "87PMm6OqszntRW3EyvVEbExRGOlpdQBay",\n                "parent": "981PKTP0_qmfuAtFjbvF1bU6uiUv8UERs",\n                "size": 4880,\n                "extension": "png",\n                "file": 1\n            }\n        ],\n        "code": "78698adcb9b711eaa7524c0082ae1a90",\n        "description": "",\n        "created_at": "2020-06-28 22:20",\n        "parent": null\n    }\n}\n\n')),Object(s.b)("h4",{id:"server_errorcontent-any--"},"server_error(",Object(s.b)("em",{parentName:"h4"},"content: any"),' = "")'),Object(s.b)("p",null,"Este m\xe9todo se utiliza para enviar una respuesta ",Object(s.b)("em",{parentName:"p"},"500 Server error")," al cliente, indicando que ocurri\xf3 alg\xfan tipo de error del servidor"),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"Par\xe1metros:")),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"content"),": Informaci\xf3n para enviar al cliente, un mensaje, un diccionario, etc. Si no existe, env\xeda un mensaje de estado basado en el c\xf3digo de estado.")),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-python"}),'\n#Retic\nfrom retic import Request, Response\n\ndef undefined(req: Request, res: Response):\n    res.server_error(\n        error_response("Controller is invalid.")\n    )\n\n')),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-sh"}),'\n# Salida:\n{\n    "valid": false,\n    "msg": "Controller is invalid."\n}\n\n')),Object(s.b)("h4",{id:"sendcontent-any--"},"send(",Object(s.b)("em",{parentName:"h4"},"content: any"),' = "")'),Object(s.b)("p",null,"Envia una respuesta de cadena en un formato(XML, CSV, texto plano). Respuestas en formato JSON, etc. Se recomienda su uso en el caso que se necesite enviar una respuesta de \xe9xito al cliente con un codigo de estado diferente de 200."),Object(s.b)("p",null,"Este m\xe9todo se utiliza en la implementaci\xf3n subyacente de la mayor\xeda de los otros m\xe9todos de respuesta de terminal."),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"Par\xe1metros:")),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"content"),": Informaci\xf3n para enviar al cliente, un mensaje, un diccionario, etc. Si no existe, env\xeda un mensaje de estado basado en el c\xf3digo de estado.")),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-python"}),'\n#Retic\nfrom retic import Request, Response\n\ndef say_hi(req: Request, res: Response):\n\n    return res.send("Hi!")\n\n')),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-sh"}),"\n# Salida:\nHi!\n\n")),Object(s.b)("h4",{id:"set_headersheaders-dict-value-str--none"},"set_headers(",Object(s.b)("em",{parentName:"h4"},"headers: dict"),", ",Object(s.b)("em",{parentName:"h4"},"value: str")," = None)"),Object(s.b)("p",null,"Establece cabeceras de respuesta con valores especificos."),Object(s.b)("p",null,"Alternativamente, se puede pasar un objeto que contenga cabeceras para configurar m\xfaltiples valores a la vez, donde las claves son los nombres de las cabeceras y los valores correspondientes son los valores deseados."),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"Par\xe1metros:")),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("p",{parentName:"li"},Object(s.b)("strong",{parentName:"p"},"headers"),": Puede ser de tipo ",Object(s.b)("inlineCode",{parentName:"p"},"dict"),", para representar un objeto de cabeceras que se agregar\xe1n a las cabeceras actuales. Si es de tipo ",Object(s.b)("inlineCode",{parentName:"p"},"str")," se utilizar\xe1 para acceder a una cabecera en especifico. Cualquier otro formato provocar\xe1 una excepci\xf3n de error.")),Object(s.b)("li",{parentName:"ul"},Object(s.b)("p",{parentName:"li"},Object(s.b)("strong",{parentName:"p"},"value"),": Valor a asignar a la cabecera especificada. Por defecto tiene un valor de ",Object(s.b)("inlineCode",{parentName:"p"},"None"),"."))),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-python"}),'\n#Retic\nfrom retic import Request, Response\n\ndef say_hi(req: Request, res: Response):\n\n    res.set_headers(\'content-type\', "text/plane")\n\n    res.ok({u"msg": "say hi!"})\n\n')),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-sh"}),'\n# Salida:\n{"msg": "say hi!"}\n\n## Cabeceras de la respuesta\ncontent-type: text/plane\n\n')),Object(s.b)("h4",{id:"set_statuscode-int"},"set_status(",Object(s.b)("em",{parentName:"h4"},"code: int"),")"),Object(s.b)("p",null,"Establezca el c\xf3digo de estado para la respuesta HTTP."),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"Par\xe1metros:")),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"code"),": N\xfamero que representa el c\xf3digo de estado de la respuesta HTTP.")),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-python"}),'\n#Retic\nfrom retic import Request, Response\n\ndef upload(req: Request, res: Response):\n\n    res.set_status(201).send({u"msg": "file created!"})\n\n')),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-sh"}),'\n# Salida:\n{\n    "msg": "file created!"\n}\n\n## C\xf3digo de estado\n201 Created\n\n')),Object(s.b)("h4",{id:"redirectnew_url-str"},"redirect(",Object(s.b)("em",{parentName:"h4"},"new_url: str"),")"),Object(s.b)("p",null,"Redirige a otra url. Utiliza redirecci\xf3n permanente con c\xf3digo de estado 308."),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"Par\xe1metros:")),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"new_utl"),": URL a redirigir.")),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-python"}),'\n#Retic\nfrom retic import Request, Response\n\ndef upload(req: Request, res: Response):\n\n    return res.redirect("http://example.com/")\n\n')),Object(s.b)("pre",null,Object(s.b)("code",Object(t.a)({parentName:"pre"},{className:"language-sh"}),"\n## C\xf3digo de estado\n308 Permanent Redirect\n...\n\n")),Object(s.b)("h3",{id:"otras-propiedades-y-funciones"},"Otras propiedades y funciones"),Object(s.b)("p",null,"Retic hereda de la clase ",Object(s.b)("inlineCode",{parentName:"p"},"Response de Werkzeug")," para la gesti\xf3n de las respuestas de peticiones, visita la documentaci\xf3n acerca de su clase ",Object(s.b)("a",Object(t.a)({parentName:"p"},{href:"https://werkzeug.palletsprojects.com/en/1.0.x/wrappers/#werkzeug.wrappers.Response"}),"Response")," para complementar la informaci\xf3n aqu\xed mencionada."))}p.isMDXComponent=!0},89:function(e,n,a){"use strict";a.d(n,"a",(function(){return b})),a.d(n,"b",(function(){return m}));var t=a(0),r=a.n(t);function s(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function o(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function c(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?o(Object(a),!0).forEach((function(n){s(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function l(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},s=Object.keys(e);for(t=0;t<s.length;t++)a=s[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)a=s[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=r.a.createContext({}),p=function(e){var n=r.a.useContext(i),a=n;return e&&(a="function"==typeof e?e(n):c(c({},n),e)),a},b=function(e){var n=p(e.components);return r.a.createElement(i.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},u=r.a.forwardRef((function(e,n){var a=e.components,t=e.mdxType,s=e.originalType,o=e.parentName,i=l(e,["components","mdxType","originalType","parentName"]),b=p(a),u=t,m=b["".concat(o,".").concat(u)]||b[u]||d[u]||s;return a?r.a.createElement(m,c(c({ref:n},i),{},{components:a})):r.a.createElement(m,c({ref:n},i))}));function m(e,n){var a=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var s=a.length,o=new Array(s);o[0]=u;var c={};for(var l in n)hasOwnProperty.call(n,l)&&(c[l]=n[l]);c.originalType=e,c.mdxType="string"==typeof e?e:t,o[1]=c;for(var i=2;i<s;i++)o[i]=a[i];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,a)}u.displayName="MDXCreateElement"}}]);